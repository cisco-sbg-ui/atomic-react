import {Meta, Preview, Story, Props} from "@storybook/addon-docs/blocks";
import {useState} from "react";

import YourComponent from "../../utils/storybook-function";
import AButton from "../AButton";
import ASelect from "./ASelect";

<Meta title="Components/Selects" component={ASelect} />

# Selects

## Install

Integrate with your build to [auto-import](?path=/docs/getting-started--page#integrating), or add an import in your component:

```
import ASelect from "@cisco-ats/atomic-react/ASelect";
// or if you're able to treekshake node_modules
import {ASelect} from "@cisco-ats/atomic-react";
```

## Usage

<Preview>
  <Story name="usage-1">
    <div style={{minHeight: 220, minWidth: 250, marginRight: 20}}>
      <h3>Simple Select</h3>
      <YourComponent>
        {() => {
          const [selectedItem, setSelectedItem] = useState(null);
          const items = [
            "Bread, Cereal, Rice, and Pasta",
            "Vegetables",
            "Fruit",
            "Milk, Yogurt, and Cheese",
            "Meat, Poultry, Fish",
            "Fats, Oils, and Sweets"
          ];
          return (
            <ASelect
              label="Food Group"
              items={items}
              placeholder="Pick a Food Group"
              onSelected={(item) => setSelectedItem(item)}
              hint={`Selected Item: ${JSON.stringify(selectedItem)}`}
            />
          );
        }}
      </YourComponent>
    </div>
  </Story>
  <Story name="usage-2">
    <div style={{minHeight: 220, minWidth: 250, marginRight: 20}}>
      <h3>Typical Select</h3>
      <YourComponent>
        {() => {
          const items = [
            {id: 1, name: "Bread, Cereal, Rice, and Pasta"},
            {id: 2, name: "Vegetables"},
            {id: 3, name: "Fruit", selected: true},
            {id: 4, name: "Milk, Yogurt, and Cheese"},
            {id: 5, name: "Meat, Poultry, Fish", disabled: true},
            {id: 6, name: "Fats, Oils, and Sweets"}
          ];
          const [selectedItem, setSelectedItem] = useState(items[2]);
          return (
            <ASelect
              label="Food Group"
              items={items}
              itemText="name"
              itemValue="id"
              placeholder="Pick a Food Group"
              onSelected={(item) => setSelectedItem(item)}
              hint={`Selected Item: ${JSON.stringify(selectedItem)}`}
            />
          );
        }}
      </YourComponent>
    </div>
  </Story>
  <Story name="usage-3">
    <div style={{minHeight: 220, minWidth: 250, marginRight: 20}}>
      <h3>Disabled Select</h3>
      <ASelect
        disabled
        label="Food Group"
        placeholder="Pick a Food Group"
        hint="Hint: Disabled"
      />
    </div>
  </Story>
  <Story name="usage-4">
    <div style={{minHeight: 220, minWidth: 250, marginRight: 20}}>
      <h3>Read-only Select</h3>
      <ASelect
        readOnly
        label="Food Group"
        placeholder="Pick a Food Group"
        hint="Hint: Read-only"
        items={[
          "Bread, Cereal, Rice, and Pasta",
          "Vegetables",
          "Fruit",
          "Milk, Yogurt, and Cheese",
          "Meat, Poultry, Fish",
          "Fats, Oils, and Sweets"
        ]}
      />
    </div>
  </Story>
  <Story name="usage-5">
    <div style={{minHeight: 220, minWidth: 250, marginRight: 20}}>
      <h3>Warning Select</h3>
      <ASelect
        validationState="warning"
        label="Food Group"
        placeholder="Pick a Food Group"
        hint="Hint: Warning"
        itemText="name"
        itemValue="id"
        items={[
          {id: 1, name: "Bread, Cereal, Rice, and Pasta"},
          {id: 2, name: "Vegetables"},
          {id: 3, name: "Fruit"},
          {id: 4, name: "Milk, Yogurt, and Cheese"},
          {id: 5, name: "Meat, Poultry, Fish", disabled: true},
          {id: 6, name: "Fats, Oils, and Sweets"}
        ]}
      />
    </div>
  </Story>
  <Story name="usage-6">
    <div style={{minHeight: 220, minWidth: 250, marginRight: 20}}>
      <h3>Danger Select</h3>
      <ASelect
        validationState="danger"
        label="Food Group"
        placeholder="Pick a Food Group"
        hint="Hint: Danger"
        items={[
          "Bread, Cereal, Rice, and Pasta",
          "Vegetables",
          "Fruit",
          "Milk, Yogurt, and Cheese",
          "Meat, Poultry, Fish",
          "Fats, Oils, and Sweets"
        ]}
      />
    </div>
  </Story>
</Preview>

## Select Props

The `ASelect` component inherits passed props.

<Props of={ASelect} />

## Validation

<Preview>
  <Story name="rules-1">
    <YourComponent>
      {() => {
        const [role, setRole] = useState(null);
        return (
          <ASelect
            items={[
              {value: 0, text: ""},
              {value: 1, text: "Read"},
              {value: 2, text: "Write"},
              {value: 3, text: "Admin"}
            ]}
            label="Role"
            required
            rules={[
              {
                test: (v) => v.value !== 3 || "Role is set to Admin",
                level: "warning"
              }
            ]}
            onSelected={(item) => setRole(item)}
          />
        );
      }}
    </YourComponent>
  </Story>
</Preview>

## Alternate Usage

<Preview>
  <Story name="alt-1">
    <div style={{minHeight: 220, minWidth: 250, marginRight: 20}}>
      <h3>Dynamic Items</h3>
      <YourComponent>
        {() => {
          const items1 = [
            {value: 1, text: "Aaa"},
            {value: 2, text: "Bbb", selected: true},
            {value: 3, text: "Ccc", disabled: true}
          ];
          const items2 = [
            {value: 1, text: "111", disabled: true},
            {value: 2, text: "222"},
            {value: 3, text: "333", selected: true}
          ];
          const [itemSet, setItemSet] = useState("items1");
          const [items, setItems] = useState(items1);
          return (
            <>
              <ASelect items={items} />
              <AButton
                className="mt-2"
                onClick={() => {
                  if (itemSet === "items1") {
                    setItemSet("items2");
                    setItems(items2);
                    return;
                  }
                  setItemSet("items1");
                  setItems(items1);
                }}>
                Swap Items
              </AButton>
            </>
          );
        }}
      </YourComponent>
    </div>
  </Story>
</Preview>

## Accessibility Notes

In addition to inheriting all of the accessibility features of `ADropdown`,
the `ASelect` surface (the box with chevron) will select and focus previous/next items
on `up` or `down` keys for the `keydown` event.

Unlike the `ADropdown` component, opening the menu will focus the selected item if one exists.

Because the HTML `select` element is not used, the surface uses the
[aria-labelledby](https://www.w3.org/TR/wai-aria/#aria-labelledby) attribute to refer to the
label, if one is present.
